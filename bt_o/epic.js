const _0x7af85=_0x56dd;(function(_0x50a731,_0x531192){const _0x2dde3d=_0x56dd,_0x234e8a=_0x50a731();while(!![]){try{const _0x4287f8=parseInt(_0x2dde3d(0x1d3))/0x1*(-parseInt(_0x2dde3d(0x1fb))/0x2)+parseInt(_0x2dde3d(0x1e4))/0x3*(-parseInt(_0x2dde3d(0x1f5))/0x4)+-parseInt(_0x2dde3d(0x1d5))/0x5*(-parseInt(_0x2dde3d(0x1d9))/0x6)+-parseInt(_0x2dde3d(0x1ed))/0x7*(parseInt(_0x2dde3d(0x1e7))/0x8)+parseInt(_0x2dde3d(0x1e8))/0x9+parseInt(_0x2dde3d(0x1de))/0xa*(-parseInt(_0x2dde3d(0x1e2))/0xb)+parseInt(_0x2dde3d(0x1d8))/0xc;if(_0x4287f8===_0x531192)break;else _0x234e8a['push'](_0x234e8a['shift']());}catch(_0x23f83b){_0x234e8a['push'](_0x234e8a['shift']());}}}(_0x4546,0xb751f));import{gCalcLatLonNorthRotationMatrix}from'./utils.js';import{gControlState}from'./controlparams.js';import{gEpicTimeSec,gSetEpicTimeSec}from'./app.js';import{gEpicImageLoader}from'./epic_image_loader.js';export let gEpicStartTimeSec=undefined;export let gEpicEndTimeSec=undefined;const NASA_API_KEY=_0x7af85(0x202),CACHE_DATE='',EPIC_JSON_URL=_0x7af85(0x1f4),EPIC_IMAGE_URL=_0x7af85(0x1e9),today=new Date()[_0x7af85(0x1ea)]()[_0x7af85(0x1f7)](0x0,0xa),NO_CACHE=![];function GetAPIKey(){const _0x1052f4=_0x7af85;return NASA_API_KEY!=''?_0x1052f4(0x1d7)+NASA_API_KEY:'';}function GetNoiseKey(){const _0x2c944f=_0x7af85;return NO_CACHE?_0x2c944f(0x1df)+Math[_0x2c944f(0x1d1)](Date[_0x2c944f(0x1f6)]()/0x3e8):'';}async function nasa_api_json(_0x31452d){const _0x1d31a4=_0x7af85;console['log'](_0x1d31a4(0x1db)+_0x31452d+'\x27');if(!NO_CACHE){const _0x470b3b=localStorage['getItem'](CACHE_DATE),_0x11ee6f=localStorage[_0x1d31a4(0x1fe)](_0x31452d);if(_0x470b3b===today&&_0x11ee6f)try{return JSON['parse'](_0x11ee6f);}catch(_0x17e94d){console['error'](_0x1d31a4(0x1f3),_0x17e94d);}}try{const _0x1d7e47=EPIC_JSON_URL+_0x31452d+GetAPIKey(),_0x326f17=await fetch(_0x1d7e47),_0x4fa850=await _0x326f17['text']();return localStorage[_0x1d31a4(0x1ee)](CACHE_DATE,today),localStorage['setItem'](_0x31452d,_0x4fa850),JSON[_0x1d31a4(0x1dc)](_0x4fa850);}catch(_0x104007){return console[_0x1d31a4(0x203)](_0x1d31a4(0x1e1),_0x104007),null;}}function updateLoadingText(_0x5f52a7){const _0x160a51=_0x7af85;if(!gControlState||!gControlState[_0x160a51(0x1e0)])_0x5f52a7='';document['getElementById'](_0x160a51(0x1f9))[_0x160a51(0x1ff)]=_0x5f52a7;}document['getElementById'](_0x7af85(0x1f9))[_0x7af85(0x1ff)]=_0x7af85(0x1fd);let all_days,epicImageDataArray;function _0x56dd(_0x3cfe76,_0x2bc2b9){const _0x4546fa=_0x4546();return _0x56dd=function(_0x56ddee,_0x39d4bf){_0x56ddee=_0x56ddee-0x1d0;let _0x36557a=_0x4546fa[_0x56ddee];return _0x36557a;},_0x56dd(_0x3cfe76,_0x2bc2b9);}const latestDayIndex=0x0;function _0x4546(){const _0x3f98d0=['round','10nwPmtW','&noise=','showText','Error\x20loading\x20JSON:','1019689hbEJno','getUTCSeconds','3sFeOKp','setDate','concat','136CGgpPQ','7022151vAVxdt','https://api.nasa.gov/EPIC/archive/natural/','toISOString','getDate','log','141764UTNPxF','setItem','loadImage','date/','all','getTime','Invalid\x20JSON\x20in\x20cache:\x20','https://api.nasa.gov/EPIC/api/natural/','5549584iwoAOe','now','slice','Loading...\x20','loading-text','then','9634ATQzZM','Loading\x20data\x20from\x20','Loading...','getItem','textContent','setUTCHours','date','mkFSJvkb5TdUAEUtdWpAwPDEJxicFOCmuKuht0q4','error','No\x20next\x20date\x20found.','floor','resolve','170BlytTr','findIndex','3482920umQcwJ','No\x20previous\x20date\x20found.','?api_key=','14648892NbMCYe','12RTUHik','length','Loading\x20JSON:\x20\x27','parse'];_0x4546=function(){return _0x3f98d0;};return _0x4546();}nasa_api_json(_0x7af85(0x1f1))['then'](_0x4aad5a=>{const _0x20700e=_0x7af85;return all_days=_0x4aad5a,gLoadEpicImagesForDate(gControlState['date']?gControlState[_0x20700e(0x201)]:all_days[latestDayIndex][_0x20700e(0x201)]);});export async function gLoadEpicImagesForDate(_0x1ba9a8){return nasa_load_epic_day(_0x1ba9a8);}function getEndOfDayMidnight(_0xac53a0=new Date()){const _0x17c7bd=_0x7af85,_0x2f5675=new Date(_0xac53a0);return _0x2f5675['setUTCHours'](0x0,0x0,0x0,0x0),_0x2f5675[_0x17c7bd(0x1e5)](_0x2f5675[_0x17c7bd(0x1eb)]()+0x1),_0x2f5675;}function getStartOfDayMidnight(_0x5ec553=new Date()){const _0x553166=_0x7af85,_0x4803bf=new Date(_0x5ec553);return _0x4803bf[_0x553166(0x200)](0x0,0x0,0x0,0x0),_0x4803bf;}function getCurrentTimeAtDay(_0x5c0057=new Date()){const _0x13cb91=_0x7af85,_0x409de6=new Date(),_0x267498=_0x409de6['getUTCHours'](),_0x2887b2=_0x409de6['getUTCMinutes'](),_0x1e784b=_0x409de6[_0x13cb91(0x1e3)]();return _0x5c0057[_0x13cb91(0x200)](_0x267498,_0x2887b2,_0x1e784b,0x0),_0x5c0057;}function nasa_load_epic_day(_0x19cb6d){const _0x569783=_0x7af85;updateLoadingText(_0x569783(0x1fc)+_0x19cb6d),nasa_api_json(_0x569783(0x1f0)+_0x19cb6d)[_0x569783(0x1fa)](_0x449320=>{const _0x13180a=_0x569783;epicImageDataArray=_0x449320;const _0x5019ae=all_days[_0x13180a(0x1d4)](_0x3d2846=>_0x3d2846['date']===_0x19cb6d),_0x1e7491=_0x5019ae!==-0x1&&_0x5019ae+0x1<all_days[_0x13180a(0x1da)]?all_days[_0x5019ae+0x1][_0x13180a(0x201)]:null;return _0x1e7491?(updateLoadingText(_0x13180a(0x1fc)+_0x1e7491),nasa_api_json(_0x13180a(0x1f0)+_0x1e7491)):(console[_0x13180a(0x1ec)](_0x13180a(0x1d6)),Promise[_0x13180a(0x1d2)](null));})[_0x569783(0x1fa)](_0x3ac1de=>{const _0x5013a9=_0x569783;epicImageDataArray=_0x3ac1de?_0x3ac1de['concat'](epicImageDataArray):epicImageDataArray;const _0x51c3c9=all_days[_0x5013a9(0x1d4)](_0x434e18=>_0x434e18['date']===_0x19cb6d),_0x3821ec=_0x51c3c9>=0x1?all_days[_0x51c3c9-0x1][_0x5013a9(0x201)]:null;return _0x3821ec?(updateLoadingText(_0x5013a9(0x1fc)+_0x3821ec),nasa_api_json(_0x5013a9(0x1f0)+_0x3821ec)):(console[_0x5013a9(0x1ec)](_0x5013a9(0x1d0)),Promise[_0x5013a9(0x1d2)](null));})[_0x569783(0x1fa)](_0xe6d65b=>{const _0x12a085=_0x569783;epicImageDataArray=_0xe6d65b?epicImageDataArray[_0x12a085(0x1e6)](_0xe6d65b):epicImageDataArray;let _0x26d56b=new Date(_0x19cb6d);const _0x375a47=getEndOfDayMidnight(_0x26d56b);gEpicEndTimeSec=_0x375a47[_0x12a085(0x1f2)]()/0x3e8;let _0x8a3ebd;for(let _0x1c5365=0x0;_0x1c5365<epicImageDataArray[_0x12a085(0x1da)];_0x1c5365++){if(epicImageDataArray[epicImageDataArray['length']-0x1-_0x1c5365]){_0x8a3ebd=new Date(epicImageDataArray[epicImageDataArray[_0x12a085(0x1da)]-0x1][_0x12a085(0x201)])[_0x12a085(0x1f2)]()/0x3e8;break;}}if(gEpicEndTimeSec>_0x8a3ebd)gEpicEndTimeSec=_0x8a3ebd;gEpicStartTimeSec=gEpicEndTimeSec-0x18*0x3c*0x3c;const _0x4fd8ae=new Date(gEpicStartTimeSec*0x3e8);(!gEpicTimeSec||gEpicTimeSec<gEpicStartTimeSec||gEpicTimeSec>gEpicEndTimeSec)&&(_0x26d56b=getCurrentTimeAtDay(_0x26d56b),gSetEpicTimeSec(_0x26d56b[_0x12a085(0x1f2)]()/0x3e8));let _0xfb1b0=0x0;for(;_0xfb1b0<=epicImageDataArray[_0x12a085(0x1da)];_0xfb1b0++){if(epicImageDataArray[_0xfb1b0]&&_0x4fd8ae<=new Date(epicImageDataArray[_0xfb1b0][_0x12a085(0x201)]))break;}_0xfb1b0--;let _0x59657b=0x0;for(;_0x59657b<epicImageDataArray['length'];_0x59657b++){if(_0x375a47<=new Date(epicImageDataArray[_0x59657b]['date']))break;}let _0x277869=0x0,_0x2d7aa4=_0x59657b-_0xfb1b0;for(let _0x197885=_0xfb1b0;_0x197885<=_0x59657b;_0x197885++){let _0x459850=epicImageDataArray[_0x197885];if(!_0x459850){updateLoadingText('');break;}const _0x20dfa9=new Date(_0x459850[_0x12a085(0x201)]);if(_0x20dfa9>=_0x375a47){updateLoadingText('');break;}gEpicImageLoader[_0x12a085(0x1ef)](_0x459850,{'onLoaded':()=>{const _0x109230=_0x12a085;_0x277869++,_0x277869<_0x2d7aa4?updateLoadingText(_0x109230(0x1f8)+Math[_0x109230(0x1dd)](0xa+_0x277869*0x5a/_0x2d7aa4)+'%'):updateLoadingText('');},'onEvict':()=>{_0x277869--;}});}});}