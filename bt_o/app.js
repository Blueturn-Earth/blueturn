const _0xf51e4d=_0x3dfa;(function(_0x43b255,_0x394808){const _0x2cdac7=_0x3dfa,_0x4762b8=_0x43b255();while(!![]){try{const _0x646aef=-parseInt(_0x2cdac7(0x1b5))/0x1+parseInt(_0x2cdac7(0x18f))/0x2+-parseInt(_0x2cdac7(0x1b4))/0x3+parseInt(_0x2cdac7(0x1ad))/0x4*(parseInt(_0x2cdac7(0x1be))/0x5)+-parseInt(_0x2cdac7(0x1aa))/0x6*(parseInt(_0x2cdac7(0x19c))/0x7)+-parseInt(_0x2cdac7(0x17e))/0x8*(parseInt(_0x2cdac7(0x186))/0x9)+parseInt(_0x2cdac7(0x187))/0xa;if(_0x646aef===_0x394808)break;else _0x4762b8['push'](_0x4762b8['shift']());}catch(_0x447453){_0x4762b8['push'](_0x4762b8['shift']());}}}(_0x2e33,0x2feb9));import{vec3,mat3}from'https://esm.sh/gl-matrix';import{gControlState}from'./controlparams.js';import{gEpicStartTimeSec,gEpicEndTimeSec}from'./epic.js';import{gEpicImageLoader}from'./epic_image_loader.js';import{gScreen}from'./screen.js';import{gCalcLatLonNorthRotationMatrix,gCalcNormalFromScreenCoord,gCalcLatLonFromScreenCoord}from'./utils.js';export let gEpicZoom=![];export let gEpicTimeSec=undefined;export let gEpicImageData0=undefined;export let gEpicImageData1=undefined;export let gEpicImageData=undefined;export let gPivotEpicImageData=undefined;document[_0xf51e4d(0x1bc)](_0xf51e4d(0x177))[_0xf51e4d(0x19d)](_0xf51e4d(0x1b3),function(){const _0x3caa5f=_0xf51e4d;gtag(_0x3caa5f(0x184),_0x3caa5f(0x1ca),{'button_id':_0x3caa5f(0x177)});});const canvas=document[_0xf51e4d(0x1bc)](_0xf51e4d(0x18c));let epicPressTime=undefined,holding=![],longPressing=![],currentTimeSpeed=0x0,pivotStartPos=undefined;gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x194),_0xcf7896=>{gEpicTimeSec&&(epicPressTime=gEpicTimeSec,holding=!![]);}),gScreen[_0xf51e4d(0x19d)]('up',_0x4d2901=>{const _0x52924d=_0xf51e4d;longPressing&&(setZoom(![],_0x4d2901[_0x52924d(0x1b7)]),epicPressTime=undefined,longPressing=![]),holding=![];});function getPivotNormal(_0x3a2f77,_0x3cf16b,_0xcc7228){const _0x28d9f8=_0xf51e4d;let _0x4d28f4=gCalcNormalFromScreenCoord(_0x3a2f77,_0x3cf16b[_0x28d9f8(0x1bb)]/0x2*Math[_0x28d9f8(0x1bd)](canvas['width'],canvas['height']),canvas[_0x28d9f8(0x17b)],canvas[_0x28d9f8(0x176)]),_0x566f78=mat3[_0x28d9f8(0x1c8)]();return mat3[_0x28d9f8(0x189)](_0x566f78,_0x3cf16b[_0x28d9f8(0x193)]),mat3[_0x28d9f8(0x199)](_0x566f78,_0x566f78,_0xcc7228[_0x28d9f8(0x193)]),mat3[_0x28d9f8(0x199)](_0x4d28f4,_0x566f78,_0x4d28f4),_0x4d28f4;}export function gSetEpicTimeSec(_0x5cfd96){const _0x135245=gEpicTimeSec;gEpicTimeSec=_0x5cfd96;if(gEpicZoom){gUpdateEpicInterpolation();const _0x205c8c=getPivotNormal(pivotStartPos,gPivotEpicImageData,gEpicImageData);_0x205c8c[0x2]<0x0&&(gEpicTimeSec=_0x5cfd96=_0x135245,gUpdateEpicInterpolation());if(_0x5cfd96>gEpicEndTimeSec)_0x5cfd96=gEpicEndTimeSec;if(_0x5cfd96<gEpicStartTimeSec)_0x5cfd96=gEpicStartTimeSec;}else{if(_0x5cfd96>gEpicEndTimeSec)_0x5cfd96=gEpicStartTimeSec;if(_0x5cfd96<gEpicStartTimeSec)_0x5cfd96=gEpicEndTimeSec;}gEpicTimeSec=_0x5cfd96,gUpdateEpicInterpolation(),updateDateText(gEpicTimeSec);}function gTagZoomEvent(_0x5aad86){const _0xc09e62=_0xf51e4d,_0xe29adc={'zoom':gEpicZoom,'trigger-event':_0x5aad86,'playing':gControlState[_0xc09e62(0x192)],'time':gEpicTimeSec,'lat':gPivotEpicImageData?gPivotEpicImageData[_0xc09e62(0x19f)][_0xc09e62(0x198)]:undefined,'lon':gPivotEpicImageData?gPivotEpicImageData[_0xc09e62(0x19f)]['lon']:undefined};console[_0xc09e62(0x1c4)](_0xc09e62(0x191)+JSON[_0xc09e62(0x1a2)](_0xe29adc)),gtag(_0xc09e62(0x184),_0xc09e62(0x1af),_0xe29adc);}gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x1ba),_0x393f9a=>{const _0x9bf2e1=_0xf51e4d;longPressing=!![],setZoom(!![],_0x393f9a[_0x9bf2e1(0x1b9)]),gTagZoomEvent('long-press');}),gScreen['addEventListener'](_0xf51e4d(0x1b1),_0x2e69fd=>{const _0x31f76d=_0xf51e4d;if(!gControlState[_0x31f76d(0x192)])setZoom(!gEpicZoom,_0x2e69fd[_0x31f76d(0x1c7)]);else{if(gEpicZoom)setZoom(![],_0x2e69fd['clickPos']);}gTagZoomEvent(_0x31f76d(0x1b1));}),gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x1b3),_0x17538e=>{const _0x5a8775=_0xf51e4d;gControlState[_0x5a8775(0x192)]=!gControlState[_0x5a8775(0x192)],gtag('event','play',{'playing':gControlState[_0x5a8775(0x192)],'trigger-event':'click','zoom':gEpicZoom}),holding=![];}),gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x1a6),_0x4aa1e6=>{const _0x31a569=_0xf51e4d,_0x13cd1a=_0x4aa1e6[_0x31a569(0x18e)]['x']/canvas[_0x31a569(0x17b)]*0xe10*0x18;if(epicPressTime){const _0xc2052c=gEpicTimeSec;gSetEpicTimeSec(gEpicTimeSec+_0x13cd1a,_0x4aa1e6['startPos']),currentTimeSpeed=(gEpicTimeSec-_0xc2052c)/_0x4aa1e6[_0x31a569(0x180)];}}),gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x19a),_0x456368=>{const _0x1e446e=_0xf51e4d,_0x119be0=gEpicZoom;if(!gEpicZoom&&_0x456368['wheelDelta']>0x0)setZoom(!![],_0x456368['wheelPos']);if(gEpicZoom&&_0x456368['wheelDelta']<0x0)setZoom(![],_0x456368[_0x1e446e(0x197)]);if(_0x119be0!=gEpicZoom)gTagZoomEvent(_0x1e446e(0x19a));}),gScreen[_0xf51e4d(0x19d)](_0xf51e4d(0x1a5),_0x737af9=>{const _0x3c04dc=_0xf51e4d,_0x4605e9=gEpicZoom;if(!gEpicZoom&&_0x737af9[_0x3c04dc(0x1a4)]>0x0)setZoom(!![],_0x737af9[_0x3c04dc(0x1a9)]);if(gEpicZoom&&_0x737af9[_0x3c04dc(0x1a4)]<0x0)setZoom(![],_0x737af9[_0x3c04dc(0x1a9)]);if(_0x4605e9!=gEpicZoom)gTagZoomEvent('pinch');});function createPivotEpicImageData(_0x285539,_0x59d9d0,_0x1c5a73=!![]){const _0x3f94b8=_0xf51e4d;let _0x54f63c=JSON[_0x3f94b8(0x1a0)](JSON['stringify'](_0x285539));_0x54f63c[_0x3f94b8(0x193)]=mat3['fromValues'](_0x54f63c[_0x3f94b8(0x193)][0x0],_0x54f63c[_0x3f94b8(0x193)][0x1],_0x54f63c['centroid_matrix'][0x2],_0x54f63c['centroid_matrix'][0x3],_0x54f63c[_0x3f94b8(0x193)][0x4],_0x54f63c['centroid_matrix'][0x5],_0x54f63c[_0x3f94b8(0x193)][0x6],_0x54f63c[_0x3f94b8(0x193)][0x7],_0x54f63c[_0x3f94b8(0x193)][0x8]),_0x54f63c[_0x3f94b8(0x19f)]={'x':_0x59d9d0['x'],'y':_0x59d9d0['y']};const _0x789839=gCalcLatLonFromScreenCoord(_0x54f63c['pivot_coordinates'],_0x54f63c['centroid_matrix'],_0x54f63c[_0x3f94b8(0x1bb)]/0x2*Math[_0x3f94b8(0x1bd)](canvas[_0x3f94b8(0x17b)],canvas[_0x3f94b8(0x176)]),canvas[_0x3f94b8(0x17b)],canvas[_0x3f94b8(0x176)]);if(!_0x789839)return;_0x54f63c[_0x3f94b8(0x19f)][_0x3f94b8(0x198)]=_0x789839['lat'],_0x54f63c[_0x3f94b8(0x19f)][_0x3f94b8(0x18b)]=_0x789839[_0x3f94b8(0x18b)];if(!_0x1c5a73)return _0x54f63c;const {lat:_0x32f2be,lon:_0xfca5a}=_0x54f63c[_0x3f94b8(0x19f)],_0xa39a28=Math[_0x3f94b8(0x1a3)](Date['now']()/0x3e8),_0x3ac57e=_0x3f94b8(0x1b0);return console[_0x3f94b8(0x1c4)](_0x3f94b8(0x190),_0x32f2be,'lon:',_0xfca5a),fetch('https://maps.googleapis.com/maps/api/timezone/json?location='+_0x32f2be+','+_0xfca5a+_0x3f94b8(0x17f)+_0xa39a28+'&key='+_0x3ac57e)[_0x3f94b8(0x181)](_0xf72e85=>_0xf72e85[_0x3f94b8(0x1b8)]())[_0x3f94b8(0x181)](_0x3bc9ee=>{const _0x5d5a57=_0x3f94b8;console[_0x5d5a57(0x1c4)](_0x5d5a57(0x19e),_0x3bc9ee),_0x54f63c['pivot_timezone']=_0x3bc9ee,updateDateText(gEpicTimeSec);})[_0x3f94b8(0x1ab)](_0x42a904=>{const _0x2f2952=_0x3f94b8;console[_0x2f2952(0x1bf)](_0x2f2952(0x1c1),_0x42a904);}),_0x54f63c;}function setZoom(_0x382679,_0x130fff){if(_0x382679){if(gEpicImageData){gPivotEpicImageData=createPivotEpicImageData(gEpicImageData,_0x130fff);if(!gPivotEpicImageData)return![];pivotStartPos=_0x130fff,gEpicZoom=!![];}}else gEpicZoom=![];updateDateText(gEpicTimeSec);}function mix(_0x9b90ca,_0x49eddd,_0x4fffce){return _0x9b90ca*(0x1-_0x4fffce)+_0x49eddd*_0x4fffce;}function _0x3dfa(_0x4946ba,_0x2ab373){const _0x2e3398=_0x2e33();return _0x3dfa=function(_0x3dfa36,_0x1ecf4f){_0x3dfa36=_0x3dfa36-0x176;let _0x2c892f=_0x2e3398[_0x3dfa36];return _0x2c892f;},_0x3dfa(_0x4946ba,_0x2ab373);}function _0x2e33(){const _0x55b78f=['timeSpeed','clickPos','create','short','button_click','height','btLogo','toFixed','GMT','Shown\x20Timezone\x20for\x20','width','timeZoneEventTimeMs','ZERO_RESULTS','48NrigpN','&timestamp=','deltaTime','then','toLocaleString','time_sec','event','2-digit','526887YnzTXf','8763320hhBPsk','current-time-text','transpose','centroid_coordinates','lon','glcanvas','shown-local-time','deltaPos','481266GgEKoT','Fetching\x20timezone\x20for\x20lat:','Zoom\x20event:\x20','playing','centroid_matrix','down','timeZoneName','status','wheelPos','lat','multiply','mousewheel','getTime','37849VxyUGL','addEventListener','timezone:','pivot_coordinates','parse','timeZoneId','stringify','floor','pinchDelta','pinch','drag','pivot_timezone','numeric','pinchCenterPos','318rDOoiR','catch','timeZone','75836eeMgpI','timeSec','zoom','AIzaSyA5G5wpnUkc_3cKFUVGfJVjtCATeTCEFF8','double-click','showText','click','737349bLdLRo','169785XGgwkM','long','upPos','json','startPos','long-press','earthRadius','getElementById','min','35dYFfnT','error','replace','Timezone\x20API\x20error:','mix01','Failed\x20to\x20find\x20pair\x20of\x20bound\x20images','log','ms:\x20'];_0x2e33=function(){return _0x55b78f;};return _0x2e33();}let lastUpdateTime=undefined;function lerp(_0x56493e,_0x569ac8,_0x39df21){return _0x56493e+_0x39df21*(_0x569ac8-_0x56493e);}export function gUpdateEpicTime(_0x2c7ec4){const _0x1f9fee=_0xf51e4d;if(!gEpicStartTimeSec||!gEpicEndTimeSec||!gEpicTimeSec)return;const _0x2cca23=gControlState[_0x1f9fee(0x192)]?gControlState[_0x1f9fee(0x1c6)]:0x0;if(!holding){if(lastUpdateTime){const _0x8f8f89=(_0x2c7ec4-lastUpdateTime)/0x3e8;currentTimeSpeed=lerp(currentTimeSpeed,_0x2cca23,0.1),gSetEpicTimeSec(gEpicTimeSec+_0x8f8f89*currentTimeSpeed);}}lastUpdateTime=_0x2c7ec4,gUpdateEpicInterpolation();}export function gUpdateEpicInterpolation(){const _0x562499=_0xf51e4d;let _0x53e925=undefined,_0x270433=undefined;for(let [_0x26210f,_0x27c819]of gEpicImageLoader['epicImageDataMap']){_0x26210f<=gEpicTimeSec&&(_0x53e925==undefined||_0x53e925<_0x26210f)&&(_0x53e925=_0x27c819[_0x562499(0x1ae)]=_0x26210f,gEpicImageData0=_0x27c819),_0x26210f>gEpicTimeSec&&(_0x270433==undefined||_0x270433>_0x26210f)&&(_0x270433=_0x27c819[_0x562499(0x1ae)]=_0x26210f,gEpicImageData1=_0x27c819);}if(_0x53e925==undefined&&_0x270433==undefined){console['log'](_0x562499(0x1c3));return;}let _0x839f0f;if(_0x53e925==undefined)gEpicImageData0=gEpicImageData1,_0x53e925=_0x270433,_0x839f0f=0x1;else _0x270433==undefined?(gEpicImageData1=gEpicImageData0,_0x270433=_0x53e925,_0x839f0f=0x0):_0x839f0f=(gEpicTimeSec-_0x53e925)/(_0x270433-_0x53e925);let _0x462d47={};_0x462d47[_0x562499(0x183)]=gEpicTimeSec,_0x462d47[_0x562499(0x1c2)]=_0x839f0f;let _0x38e241=gEpicImageData0[_0x562499(0x1bb)],_0x2dce85=gEpicImageData1[_0x562499(0x1bb)];_0x462d47['earthRadius']=mix(_0x38e241,_0x2dce85,_0x462d47[_0x562499(0x1c2)]);let _0x3115b4=gEpicImageData0[_0x562499(0x18a)]['lat'],_0x3c5caa=gEpicImageData0[_0x562499(0x18a)]['lon'],_0x58fbbf=gEpicImageData1[_0x562499(0x18a)][_0x562499(0x198)],_0x4a617f=gEpicImageData1['centroid_coordinates'][_0x562499(0x18b)];if(_0x4a617f>_0x3c5caa)_0x3c5caa+=0x168;_0x462d47[_0x562499(0x18a)]={},_0x462d47[_0x562499(0x18a)][_0x562499(0x198)]=mix(_0x3115b4,_0x58fbbf,_0x462d47['mix01']),_0x462d47[_0x562499(0x18a)][_0x562499(0x18b)]=mix(_0x3c5caa,_0x4a617f,_0x462d47[_0x562499(0x1c2)]),_0x462d47[_0x562499(0x193)]=gCalcLatLonNorthRotationMatrix(_0x462d47[_0x562499(0x18a)][_0x562499(0x198)],_0x462d47[_0x562499(0x18a)][_0x562499(0x18b)]),gEpicImageData=_0x462d47;}let lastTimeZoneEvent=undefined,wasTimezoneFound=undefined;function updateDateText(_0x2fb5a0){const _0x2629a6=_0xf51e4d;if(!gControlState[_0x2629a6(0x1b2)])return;const _0x2dd5fa=new Date(_0x2fb5a0*0x3e8);let _0xafe09c='',_0x140a2c=undefined;gEpicZoom&&gPivotEpicImageData&&gPivotEpicImageData[_0x2629a6(0x19f)]&&(gPivotEpicImageData[_0x2629a6(0x1a7)]&&gPivotEpicImageData['pivot_timezone'][_0x2629a6(0x196)]!=_0x2629a6(0x17d)?_0xafe09c+='\x20('+gPivotEpicImageData[_0x2629a6(0x1a7)][_0x2629a6(0x1a1)]+')\x0a':_0xafe09c+='['+gPivotEpicImageData['pivot_coordinates']['lat'][_0x2629a6(0x178)](0x2)+',\x20'+gPivotEpicImageData[_0x2629a6(0x19f)][_0x2629a6(0x18b)][_0x2629a6(0x178)](0x2)+']\x20\x0a');let _0x15f38d={'timeZoneName':'long','hour12':![],'minute':_0x2629a6(0x185),'hour':_0x2629a6(0x185),'day':_0x2629a6(0x185),'month':_0x2629a6(0x185),'year':_0x2629a6(0x1a8)};gEpicZoom&&gPivotEpicImageData&&gPivotEpicImageData[_0x2629a6(0x1a7)]&&gPivotEpicImageData[_0x2629a6(0x1a7)]['timeZoneId']?(_0x15f38d[_0x2629a6(0x1ac)]=gPivotEpicImageData[_0x2629a6(0x1a7)][_0x2629a6(0x1a1)],_0x15f38d[_0x2629a6(0x195)]=_0x2629a6(0x1b6),_0x140a2c=!![]):(_0x15f38d[_0x2629a6(0x1ac)]=_0x2629a6(0x179),_0x15f38d['timeZoneName']=_0x2629a6(0x1c9),_0x140a2c=![]);_0xafe09c+=_0x2dd5fa[_0x2629a6(0x182)]('en-GB',_0x15f38d),_0xafe09c=_0xafe09c[_0x2629a6(0x1c0)](/(.*\d{2}:\d{2})\s*(.*)$/,'$1\x20($2)'),document[_0x2629a6(0x1bc)](_0x2629a6(0x188))['textContent']=_0xafe09c;const _0x52eeec=new Date()[_0x2629a6(0x19b)]();let _0x1af016=undefined;_0x140a2c&&!wasTimezoneFound&&(_0x1af016={'timeZoneId':gPivotEpicImageData&&gPivotEpicImageData[_0x2629a6(0x1a7)]?gPivotEpicImageData[_0x2629a6(0x1a7)][_0x2629a6(0x1a1)]:undefined,'timeZoneName':gPivotEpicImageData&&gPivotEpicImageData[_0x2629a6(0x1a7)]?gPivotEpicImageData['pivot_timezone'][_0x2629a6(0x195)]:undefined,'timeZoneEventTimeMs':_0x52eeec});;if(!_0x140a2c&&lastTimeZoneEvent){const _0x65956d=_0x52eeec-lastTimeZoneEvent[_0x2629a6(0x17c)];console[_0x2629a6(0x1c4)](_0x2629a6(0x17a)+_0x65956d+_0x2629a6(0x1c5)+JSON[_0x2629a6(0x1a2)](lastTimeZoneEvent)),gtag('event',_0x2629a6(0x18d),{'timezoneId':lastTimeZoneEvent[_0x2629a6(0x1a1)],'timezoneName':lastTimeZoneEvent[_0x2629a6(0x195)],'showDuration':_0x65956d});}lastTimeZoneEvent=_0x1af016,wasTimezoneFound=_0x140a2c;}