function _0x5170(){const _0x14ad2c=['earthRadius','_getNoiseQueryParamString','21931vbCjLj','298TDBdlX','get','1899054PsXLJL','api_key=','getElementById','sqrt','dscovr_j2000_position','7269GnkztP','markUsed','isPending','epicImageDataMap','1439435XOYnjz','warn','Loaded\x20image:\x20',',\x20for\x20date\x20','noise=','1089qZIgtD','5604858fhwHDb','48670jeJJOP','Aborted\x20loading\x20texture\x20for\x20image\x20','centroid_matrix','_completeEpicMetadata','image','Evicted\x20image:\x20','mkFSJvkb5TdUAEUtdWpAwPDEJxicFOCmuKuht0q4','date','imageURL','set','lon','loadTexture','jpg','_calcEarthRadiusFromDistance','glcanvas','_getAPIKeyQueryParamString','floor','centroid_coordinates','error','texture','752dEGrYS','444715GeWAaK','8Bqblis','now'];_0x5170=function(){return _0x14ad2c;};return _0x5170();}const _0x4f9fce=_0x5c26;(function(_0x573fcb,_0x12be6b){const _0x1d1808=_0x5c26,_0x860900=_0x573fcb();while(!![]){try{const _0x1f653c=-parseInt(_0x1d1808(0xf9))/0x1+-parseInt(_0x1d1808(0xff))/0x2*(parseInt(_0x1d1808(0x106))/0x3)+parseInt(_0x1d1808(0xfa))/0x4*(-parseInt(_0x1d1808(0x10a))/0x5)+parseInt(_0x1d1808(0x101))/0x6+parseInt(_0x1d1808(0xfe))/0x7*(parseInt(_0x1d1808(0xf8))/0x8)+parseInt(_0x1d1808(0x110))/0x9+parseInt(_0x1d1808(0x111))/0xa*(parseInt(_0x1d1808(0x10f))/0xb);if(_0x1f653c===_0x12be6b)break;else _0x860900['push'](_0x860900['shift']());}catch(_0x30f481){_0x860900['push'](_0x860900['shift']());}}}(_0x5170,0x5190a));import{TextureLoader}from'./texture_loader.js';import{gCalcLatLonNorthRotationMatrix}from'./utils.js';const NASA_API_KEY=_0x4f9fce(0x117),EPIC_IMAGE_URL='https://api.nasa.gov/EPIC/archive/natural/',IMAGE_FORMAT=_0x4f9fce(0x11d),NO_CACHE=![],canvas=document[_0x4f9fce(0x103)](_0x4f9fce(0x11f)),gl=canvas['getContext']('webgl2');class EpicImageLoader{#MAX_IMAGES=0x64;#textureLoader=new TextureLoader(gl,{'maxGPUMemoryBytes':this.#MAX_IMAGES*0x800*0x800*0x4});[_0x4f9fce(0x109)]=new Map();async['loadImage'](_0x3cea32,{onLoaded:_0xa36de1,onEvict:_0x94222}){const _0x308f4e=_0x4f9fce,_0x4228e7=new Date(_0x3cea32['date'])['getTime']()/0x3e8,_0x23ca11=this[_0x308f4e(0x109)][_0x308f4e(0x100)](_0x4228e7);_0x23ca11!==_0x3cea32&&(this['epicImageDataMap'][_0x308f4e(0x11a)](_0x4228e7,_0x3cea32),this[_0x308f4e(0x114)](_0x3cea32));if(!_0x3cea32[_0x308f4e(0xf7)]&&(!_0x3cea32[_0x308f4e(0x119)]||!this.#textureLoader[_0x308f4e(0x108)](_0x3cea32[_0x308f4e(0x119)]))){const _0x48983b=_0x3cea32[_0x308f4e(0x118)]['replaceAll']('-','/')['split']('\x20')[0x0],_0x56d8e0=_0x3cea32['image'],_0x553017=EPIC_IMAGE_URL+_0x48983b+'/'+IMAGE_FORMAT+'/'+_0x56d8e0+'.'+IMAGE_FORMAT+'?'+this['_getAPIKeyQueryParamString']()+'&'+this[_0x308f4e(0xfd)]();_0x3cea32['imageURL']=_0x553017,this.#textureLoader[_0x308f4e(0x11c)](_0x553017,{'forceReload':![],'onSuccess':(_0x25bc8b,_0x53f6cc)=>{const _0x5a5305=_0x308f4e;_0x3cea32[_0x5a5305(0xf7)]=_0x53f6cc,console['log'](_0x5a5305(0x10c)+_0x3cea32[_0x5a5305(0x115)]+_0x5a5305(0x10d)+_0x3cea32[_0x5a5305(0x118)]),_0xa36de1?.();},'onError':(_0x523663,_0x26ea7f)=>{const _0xb623b5=_0x308f4e;console[_0xb623b5(0x123)]('Error\x20loading\x20texture\x20for\x20image\x20'+_0x56d8e0+',\x20'+_0x26ea7f);},'onAbort':(_0x773d8f,_0x785fba)=>{const _0x3c32fa=_0x308f4e;console[_0x3c32fa(0x10b)](_0x3c32fa(0x112)+_0x56d8e0+',\x20'+_0x785fba);},'onEvict':(_0x120bc2,_0x24a692)=>{const _0x5a573a=_0x308f4e;_0x3cea32[_0x5a573a(0xf7)]=null,console[_0x5a573a(0x10b)](_0x5a573a(0x116)+_0x3cea32[_0x5a573a(0x115)]+_0x5a573a(0x10d)+_0x3cea32[_0x5a573a(0x118)]),_0x94222?.();}});}}[_0x4f9fce(0x107)](_0x55273e){const _0x1def44=_0x4f9fce;this.#textureLoader[_0x1def44(0x107)](_0x55273e['imageURL']);}[_0x4f9fce(0x120)](){const _0x5ec832=_0x4f9fce;return NASA_API_KEY!=''?_0x5ec832(0x102)+NASA_API_KEY:'';}[_0x4f9fce(0xfd)](){const _0x12e29b=_0x4f9fce;return NO_CACHE?_0x12e29b(0x10e)+Math[_0x12e29b(0x121)](Date[_0x12e29b(0xfb)]()/0x3e8):'';}[_0x4f9fce(0x11e)](_0x31aefa){return(0x400-0x9e)/0x400*0x15282c/_0x31aefa;}['_completeEpicMetadata'](_0x15626c){const _0x35ac13=_0x4f9fce,_0xe62779=_0x15626c[_0x35ac13(0x105)]['x'],_0x27a9ee=_0x15626c[_0x35ac13(0x105)]['y'],_0x489ecf=_0x15626c['dscovr_j2000_position']['z'],_0x4b67e1=Math[_0x35ac13(0x104)](_0xe62779*_0xe62779+_0x27a9ee*_0x27a9ee+_0x489ecf*_0x489ecf);_0x15626c[_0x35ac13(0xfc)]=this[_0x35ac13(0x11e)](_0x4b67e1),_0x15626c[_0x35ac13(0x113)]=gCalcLatLonNorthRotationMatrix(_0x15626c['centroid_coordinates']['lat'],_0x15626c[_0x35ac13(0x122)][_0x35ac13(0x11b)]);}}function _0x5c26(_0x33cebf,_0x213ddb){const _0x517071=_0x5170();return _0x5c26=function(_0x5c268e,_0x5155c5){_0x5c268e=_0x5c268e-0xf7;let _0x42a579=_0x517071[_0x5c268e];return _0x42a579;},_0x5c26(_0x33cebf,_0x213ddb);}export const gEpicImageLoader=new EpicImageLoader();